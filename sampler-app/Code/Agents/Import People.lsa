<?xml version='1.0' encoding='utf-8'?>
<agent name='Import People' xmlns='http://www.lotus.com/dxl' version='9.0'
 maintenanceversion='1.0' replicaid='80257D3A003BCC3B' hide='v3' publicaccess='false'
 designerversion='8.5.3'>
<noteinfo noteid='212' unid='D80DFC569116D26680257CD8002C3432' sequence='8'>
<created><datetime dst='true'>20140514T090249,46+01</datetime></created>
<modified><datetime dst='true'>20140820T120832,34+01</datetime></modified>
<revised><datetime dst='true'>20140820T120832,33+01</datetime></revised>
<lastaccessed><datetime dst='true'>20140820T120832,34+01</datetime></lastaccessed>
<addedtofile><datetime dst='true'>20140820T115316,89+01</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Matt White/O=Exhilarate</name></updatedby>
<wassignedby><name>CN=Matt White/O=Exhilarate</name></wassignedby>
<designchange><datetime dst='true'>20140807T120808,21+01</datetime></designchange>
<trigger type='actionsmenu'/>
<documentset type='runonce'/><code event='options'><lotusscript>%REM
	Agent Import People
	Created Oct 9, 2013 by Matt White/Exhilarate
	Description: Comments for Agent
%END REM
Option Public
Option Declare


</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	Dim sess As New NotesSession
	Dim db As NotesDatabase
	Dim sline As Variant
	Dim FirstName, LastName, Company, StreetAddress, City, ZipCode, Country, Phone, Email, InitialContactDate, sex
	Dim fileNum%
	Dim fileCSV As Variant
	Dim uiws As New NotesUIWorkspace
	Dim i As Integer
	Dim imale As Integer
	Dim ifemale As Integer
	
	firstname = 0
	lastname = 1
	company = 2
	streetaddress = 3
	city = 4
	zipcode = 5
	country = 6
	phone = 7
	email = 8
	initialcontactdate = 9
	sex = 10
	
	
	Set db = sess.Currentdatabase
	fileNum = Freefile
	fileCSV = uiws.Openfiledialog(False, "Choose the CSV File", "*.csv", "Z:\Dropbox\TeamStudio Unplugged\Custom Control Library\")
	If Not Isempty(filecsv) Then
		Open fileCSV(0) For Input As fileNum%
		i = 0
		imale = 1
		ifemale = 1
		Do Until Eof(fileNum%)
			Line Input #fileNum%, sline
			sline = Split(sline, ",")
			Dim docNew As NotesDocument
			Set docNew = db.Createdocument()
			docNew.Form = "Person"
			docNew.FirstName = sline(FirstName)
			docNew.LastName = sline(LastName)
			docNew.Company = sline(Company)
			docNew.StreetAddress = Replace(sline(StreetAddress), ";", ",")
			docNew.City = sline(City)
			docNew.ZipCode = sline(ZipCode)
			docNew.Country = Replace(sline(Country), ";", ",")
			docNew.Phone = sline(Phone)
			docNew.Email = sline(Email)
			docNew.InitialContactDate = Cdat(sline(initialContactDate))
			docNew.sex = sline(sex)
			
			Dim rtitem As NotesRichTextItem
			Set rtitem = docNew.Createrichtextitem("thumbnail")
			Dim path As String
			path = "Z:\Dropbox\TeamStudio Unplugged\Custom Control Library\people\"
			If sline(sex) = "Male" Then
				path = path &amp; "male\" &amp; imale &amp; ".jpg"
				imale = imale + 1
			Else
				path = path &amp; "female\" &amp; ifemale &amp; ".jpg"
				ifemale = ifemale + 1
			End If
			Call rtitem.Embedobject(EMBED_ATTACHMENT, "", path)
			docNew.thumbnailfilename = Evaluate(|@AttachmentNames|, docNew)
			
			Call docNew.save(True, False)
			
			i = i + 1
		Loop
	End If
End Sub</lotusscript></code></agent>

